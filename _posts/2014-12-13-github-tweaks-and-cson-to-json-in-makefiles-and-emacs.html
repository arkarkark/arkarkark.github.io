---
comments: false
date: 2014-12-13
layout: post
permalink: /2014/12/github-tweaks-and-cson-to-json-in.html
title: Github Tweaks and CSON to JSON in Makefiles and Emacs
tags:
- chrome
- coffeescript
- cson
- development
- emacs
- github
- greasemonkey
---


<div class='post'>
<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-7lN_efUpW8Y/VIwcBrz89MI/AAAAAAAA9R4/C20DkT2EuSw/s1600/icon128.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-7lN_efUpW8Y/VIwcBrz89MI/AAAAAAAA9R4/C20DkT2EuSw/s1600/icon128.png" /></a></div>I made this <a href="https://chrome.google.com/webstore/detail/github-tweaks/igpigcnejhffkkbpfiblincbpdlpbhon">Github Tweaks Chrome Extension</a>.<br /><br />Right now it's tiny, but maybe I'll be adding more to it soon.<br /><br />I like to keep a pinned tab with my open github issues on it. However I usually end up clicking on that list and opening an issue in the pinned tab, not a new one. This extension makes all the links on the issues list page open in a new window.<br /><br />Are there any other little changes you'd like to make to the github site?<br /><br />This one was interesting because I got to learn about&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver">MutationObserver</a>.<br /><br />It was also fun writing a GNU Makefile again after all these years. I've started using cson rather than stupid json and modified emacs to automatically compile-on-save (cos) cson to json (using cson2json from <a href="https://www.npmjs.com/package/cson-cli">cson-cli</a>) just like coffee does to js files.<br /><br />I've been liking this <a href="https://chrome.google.com/webstore/detail/github-notification-helpe/gmhijkhbpihfmkmhmcfebmlkaekgmaje">Github Notification Helper for Gmail</a> quite a bit. I'd really like it if it could add and remove gmail labels based on if a bug was marked as critical or assigned to me maybe I'll break out the <a href="https://developers.google.com/apps-script/reference/gmail/">Gmail Apps Script</a> for that one.<br /><br />Here's my emacs lisp function to compile cson to json<br /><br /><span style="font-family: Courier New, Courier, monospace;"></span><br /><span style="font-family: Courier New, Courier, monospace;">(autoload 'coffee-mode "coffee-mode" nil t)</span><br /><span style="font-family: Courier New, Courier, monospace;">(add-hook 'coffee-mode-hook 'ark-coffee-cos?)</span><br /><span style="font-family: Courier New, Courier, monospace;">(mapc (lambda (a) (add-to-list 'auto-mode-alist a))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; '(</span><span style="font-family: 'Courier New', Courier, monospace;">("\\.\\(coffee\\|cson\\)$" . coffee-mode)</span><span style="font-family: 'Courier New', Courier, monospace;">))</span><br /><div><br /></div><div><span style="font-family: 'Courier New', Courier, monospace;">(defun ark-compile-cson ()</span></div><span style="font-family: Courier New, Courier, monospace;">&nbsp; "Compile a cson file to a json file (use npm install -g cson-cli to get cson2json)."</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; (interactive)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; (let* ( (input (buffer-file-name))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (basename (file-name-sans-extension input))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (output (concat basename ".json"))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (compile-cmd (concat "cson2json " input " &gt; " output))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (compiler-output (shell-command-to-string compile-cmd)))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; (if (string= compiler-output "")</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; (let ((file-name (coffee-compiled-file-name (buffer-file-name))))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; (message "Compiled and saved %s" output)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; (coffee-revert-buffer-compiled-file output))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; (message "Error compiling"))))</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">(defun ark-coffee-cos? ()</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; "Turn on Compile on Save optionally in coffee script mode"</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; (interactive)</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; (if (or</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; (and (string-match "/mysrc/" (buffer-file-name))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (not (string-match "\\.cson$" (buffer-file-name))))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; (file-exists-p (concat (file-name-sans-extension (buffer-file-name)) ".js")))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; (coffee-cos-mode t))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; (if (file-exists-p (concat (file-name-sans-extension (buffer-file-name)) ".json"))</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; (add-hook 'after-save-hook 'ark-compile-cson nil t)))</span><br /><br />Writing this blog post has made me really want to look into moving over to github pages like <a href="http://www.danvk.org/2014/10/23/fully-migrated-to-github-pages.html">danvk did</a>....</div>
<h2>Comments</h2>
<div class='comments'>
</div>
